# twelve-factors

핵심 사상
* 선언적 형식으로 설정을 자동화 -> 신규 투입 인력의 러닝커브 감소
* 운영체제에 구애받지 않고, 다양한 실행 환경에서 작동할 수 있도록 **이식성을 극대화**
* **클라우드 플랫폼 기반 개발**을 통해 서버와 시스템 관리에 대한 부담을 줄임
* 개발과 운영의 간극을 최소화 -> **지속적 배포 = continuous deployment** -> 애자일성 최대화
* 도구, 아키텍처, 개발 관행을 크게 바꾸지 않아도 수직적 확장이 가능.


## 1. code base
하나의 코드베이스와 앱 사이에서는 1:1 관계가 성립해야 한다.
(하나의 프로젝트로부터 하나의 서비스만 제공해야한다는 뜻)

## 2. dependency
애플리케이션의 의존관계는 명시적으로 선언되어야 한다. (메이븐, 그레이들과 같이)
즉, jar 파일을 다운받아서 import 하는 방식은 X.

## 3. configuration
설정 정보는 실행환경에 저장한다. (e.g. database url, cdn 주소 등)  
즉, 애플리케이션 코드와 엄격하게 분리해야 한다

스프링에서는 application.yml 같은 케이스.

## 4. backend support
데이터베이스는 리소스로 관리한다. 각 환경(운영, 개발 별로 서로 다른 데이터베이스를 간단하게 교체할 수 있어야 함.)

## 5. build, release, run
철저하게 분리된 빌드와 실행 

1. 빌드 : 소스코드를 가져와 컴파일 후 하나의 패키지를 만듬.
2. 릴리즈 : 빌드에 환경설정정보를 조합한다.(+ 버저닝)
3. 실행(런타임) : 릴리즈 버전 중 하나를 선택에 실행환경 위에 앱을 실행

## 6. port binding
서비스는 포트에 연결해서 외부에 공개. (8081, 8082 포트를 붙여서 스스로 서버를 띄울 수 있음)

## 7. concurrency
애플리케이션이 필요할 때마다 프로세스나 스레드를 수평적으로 확장해서 병렬로 실행할 수 있어야 함.

HTTP 요청이 들어오면, 서블릿 스레드가 하나 생성되고 해당 스레드가 로직을 수행함.  
톰캣의 경우 default가 200개가 한계. 말인 즉슨 200개가 넘어가면 안됨.
이럴 경우에, worker 스레드를 생성해서 해당 스레드가 작업을 수행해야 함.

## 8. disposability
graceful 하게 start / shutdown이 수행될 수 있어야 함 -> 안정성 극대화  
가능한 짧은 시간 내에 재시작되어야 함

## 9. dev/prod parity

* 시간 차이 : 변경 사항을 운영 환경에 빨리 배포할 수 있어야 함.
* 개인 차이 : 코드 변경을 맡은 개발자가 배포작업을 할 수 있어야 하고, 모니터링도 할 수 있어야 함.
* 도구 차이 : 각 실행 환경에서 사용된 기술과 프레임워크는 동일해야 함.

즉, 개발 환경과 운영 환경을 최대한 비슷하게 유지해야 한다.  
(docker가 도움을 줄 수 있을듯)

## 10. log
로그는 이벤트 스트림으로 취급, stdout에 남긴다.  
애플리케이션은 로그파일 저장에 관여하지 않아야 한다.  
집계와 저장은 애플리케이션이 아니라 실행 환경에 의해 처리되어야 한다. (think about docker)

(elasticsearch 가 로그를 담당)

## 11. admin process
admin/maintenance 작업을 일회성 프로세스로 실행.

## statless process
애플리케이션 하나 혹은 여러개의 무상태 프로세스로 실행. 상태는 외부저장소에 보관.






